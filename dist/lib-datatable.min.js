!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.lib_datatable=t():e.lib_datatable=t()}("undefined"!=typeof self?self:this,(function(){return function(e){var t={};function o(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,o),r.l=!0,r.exports}return o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){"use strict";function n(e){return void 0===e||null===e}t.value_missing=n,t.clone=function(e){return JSON.parse(JSON.stringify(e))},t.resolve_index=function(e,t){if(n(e))throw new Error("Count is required.");if(n(t))throw new Error("Index is required.");return t<0&&(t=e+t),t<0&&(t=null),t>=e&&(t=null),t},t.address2number=function(e){if(n(e))throw new Error("Address is required.");let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=(e=e.toUpperCase()).length,r=0;for(let n=0;n<e.length;n++){o--;let i=e.substr(o,1),l=t.indexOf(i)+1;if(l<=0)throw new Error(`Invalid address string [${e}].`);l*=t.length**n,r+=l}return r},t.number2address=function(e){if(n(e))throw new Error("Number is required.");for(var t="",o=1,r=26;(e-=o)>=0;o=r,r*=26)t=String.fromCharCode(parseInt(e%r/o)+65)+t;return t}},function(e,t,o){"use strict";o(0);const n=o(2),r=o(3),i=o(4),l=o(5);function s(){return{options:{blank_value:null,blank_row:[]},data:{row_base:0,col_base:0,rows:[],column_headings:[]},RowCount:n.RowCount,ColumnCount:n.ColumnCount,SetSize:n.SetSize,GetMatrix:n.GetMatrix,SetMatrix:n.SetMatrix,ToObjects:n.ToObjects,FromObjects:n.FromObjects,TransposeTable:n.TransposeTable,RowCol:r.RowCol,GetValue:r.GetValue,SetValue:r.SetValue,DeleteColumns:i.DeleteColumns,ClearColumns:i.ClearColumns,InsertBlankColumns:i.InsertBlankColumns,ColumnHeading:i.ColumnHeading,DeleteRows:l.DeleteRows,ClearRows:l.ClearRows,InsertBlankRows:l.InsertBlankRows,InsertRows:l.InsertRows}}t.NewDatatable=s,t.NewBlankDatatable=function(e,t){let o=s();return o.SetValue(o.blank_value,e-1,t-1),o},t.FromMatrix=function(e){let t=s();return t.SetMatrix(e,0,0),t}},function(e,t,o){"use strict";const n=o(0);t.RowCount=function(e){if(e<0)throw new Error("Count must be zero or positive.");if(!n.value_missing(e)){for(;e>this.data.rows.length;)this.data.rows.push([]);this.data.rows.splice(e)}return this.data.rows.length},t.ColumnCount=function(e){if(e<0)throw new Error("Count must be zero or positive.");if(!n.value_missing(e)){for(;e>this.data.column_headings.length;)this.data.column_headings.push("");this.data.column_headings.splice(e)}return this.data.column_headings.length},t.SetSize=function(e,t){if(n.value_missing(e))throw new Error("RowCount is required.");if(n.value_missing(t))throw new Error("ColCount is required.");this.RowCount(e),this.ColumnCount(t)},t.GetMatrix=function(e,t,o,n){let r=[];for(let i=e;i<=o;i++){let e=[];for(let o=t;o<=n;o++){let t=this.GetValue(i,o);e.push(t)}r.push(e)}return r},t.SetMatrix=function(e,t,o){let n=this.RowCol(t,o);if(null===n.row_index)throw new Error(`Invalid RowIndex [${n.row_index}].`);if(null===n.col_index)throw new Error(`Invalid ColIndex [${n.col_index}].`);let r=t+e.length;r>this.RowCount()&&this.RowCount(r);for(let n=0;n<e.length;n++){let r=e[n];for(let e=0;e<r.length;e++){let i=r[e],l=o+r.length;l>this.ColumnCount()&&this.ColumnCount(l),this.SetValue(i,t+n,o+e)}}},t.FromObjects=function(e){this.SetSize(e.length,0);for(let t=0;t<e.length;t++){let o=e[t],n=Object.keys(o);for(let e=0;e<n.length;e++){let r=this.data.column_headings.indexOf(n[e]);r<0&&(this.data.column_headings.push(n[e]),r=this.data.column_headings.length-1);let i=o[n[e]];this.SetValue(i,t,r)}}},t.ToObjects=function(){let e=[];for(let t=0;t<this.data.rows.length;t++){let o={};for(let e=0;e<this.data.column_headings.length;e++){let n=this.data.column_headings[e];n&&n.length||(n="column"+e),o[n]=this.GetValue(t,e)}e.push(o)}return e},t.TransposeTable=function(){let e=[];for(let t=0;t<this.data.rows.length;t++)e.push("");let t=[];for(let e=0;e<this.data.column_headings.length;e++){let o=[];for(let t=0;t<this.data.rows.length;t++)o.push(this.GetValue(t,e));t.push(o)}this.data.column_headings=e,this.data.rows=t}},function(e,t,o){"use strict";const n=o(0);t.RowCol=function(e,t){let o={row_num:null,row_addr:null,row_index:null,col_num:null,col_addr:null,col_index:null};if("object"==typeof e&&null!==e){if(n.value_missing(e.row_index))if(n.value_missing(e.row_num))n.value_missing(e.row_addr)||(o.row_index=n.address2number(e.row_addr)-1);else{if(e.row_num<0)throw new Error("RowCol.row_num must be zero or positive.");o.row_index=e.row_num-1}else e.row_index>=0?o.row_index=n.resolve_index(Number.MAX_SAFE_INTEGER,e.row_index):o.row_index=n.resolve_index(this.data.rows.length,e.row_index);if(n.value_missing(e.col_index))if(n.value_missing(e.col_num))n.value_missing(e.col_addr)||(o.col_index=n.address2number(e.col_addr)-1);else{if(e.col_num<0)throw new Error("RowCol.col_num must be zero or positive.");o.col_index=e.col_num-1}else e.col_index>=0?o.col_index=n.resolve_index(Number.MAX_SAFE_INTEGER,e.col_index):o.col_index=n.resolve_index(this.data.column_headings.length,e.col_index)}else if("string"==typeof e){for(let t=0;t<e.length;t++){let n=e.substr(t,1);if(!isNaN(parseInt(n))){o.col_addr=e.substr(0,t),o.row_num=parseInt(e.substr(t));break}}if(null===o.col_addr||null===o.row_num)throw new Error(`Invalid address [${e}].`);o.row_index=o.row_num-1,o.col_index=n.address2number(o.col_addr)-1}else n.value_missing(e)||"number"==typeof e&&(o.row_index=e>=0?n.resolve_index(Number.MAX_SAFE_INTEGER,e):n.resolve_index(this.data.rows.length,e)),n.value_missing(t)||("string"==typeof t&&(t=n.address2number(t)-1),o.col_index=t>=0?n.resolve_index(Number.MAX_SAFE_INTEGER,t):n.resolve_index(this.data.column_headings.length,t));return null!==o.row_index&&(o.row_num=o.row_index+1,o.row_addr=n.number2address(o.row_num)),null!==o.col_index&&(o.col_num=o.col_index+1,o.col_addr=n.number2address(o.col_num)),o},t.GetValue=function(e,t){let o=this.RowCol(e,t);if(null===o.row_index)throw new Error(`Invalid RowIndex [${o.row_index}].`);if(null===o.col_index)throw new Error(`Invalid ColIndex [${o.col_index}].`);if(o.row_index>=this.data.rows.length)throw new Error(`RowIndex [${o.row_index}] does not exist.`);let r=this.data.rows[o.row_index];return o.col_index>=r.length?n.clone(this.options.blank_value):r[o.col_index]},t.SetValue=function(e,t,o){let r=this.RowCol(t,o);if(null===r.row_index)throw new Error(`Invalid RowIndex [${r.row_index}].`);if(null===r.col_index)throw new Error(`Invalid ColIndex [${r.col_index}].`);let i=this.data.rows[r.row_index];for(;r.col_index>=this.data.column_headings.length;)this.data.column_headings.push("");for(;r.col_index>=i.length;)i.push(n.clone(this.options.blank_value));i[r.col_index]=e}},function(e,t,o){"use strict";const n=o(0);t.DeleteColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.ColumnCount())throw new Error("Count must be less than or equal to the number of columns.");"number"==typeof t?t={col_index:t}:"string"==typeof t&&(t={col_addr:t});let o=this.RowCol(t);if(o.col_index+e>this.ColumnCount())throw new Error("Count plus the starting index must be less than or equal to the number of columns.");this.data.column_headings.splice(o.col_index,e);for(let t=0;t<this.data.rows.length;t++){let n=this.data.rows[t];o.col_index>=n.length||n.splice(o.col_index,e)}},t.ClearColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.ColumnCount())throw new Error("Count must be less than or equal to the number of columns.");"number"==typeof t?t={col_index:t}:"string"==typeof t&&(t={col_addr:t});let o=this.RowCol(t);if(o.col_index+e>this.ColumnCount())throw new Error("Count plus the starting index must be less than or equal to the number of columns.");for(let t=0;t<this.data.rows.length;t++)for(let r=0;r<e;r++)this.SetValue(n.clone(this.options.blank_value),t,o.col_index+r)},t.InsertBlankColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");let o=!1;"number"==typeof t?(t<0&&(o=!0),t={col_index:t}):"string"==typeof t&&(t={col_addr:t});let r=this.RowCol(t),i=[];for(let t=0;t<e;t++)i.push("");this.data.column_headings.splice(r.col_index,0,...i),i=[];for(let t=0;t<e;t++)i.push(this.options.blank_value);for(let e=0;e<this.data.rows.length;e++){let t=this.data.rows[e];o?t.splice(r.col_index+1,0,...n.clone(i)):t.splice(r.col_index,0,...n.clone(i))}},t.ColumnHeading=function(e,t=null){if(n.value_missing(e))throw new Error("AtColumn is required.");"number"==typeof e?e={col_index:e}:"string"==typeof e&&(e={col_addr:e});let o=this.RowCol(e);return n.value_missing(t)||(this.data.column_headings[o.col_index]=t),this.data.column_headings[o.col_index]}},function(e,t,o){"use strict";const n=o(0);t.DeleteRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.RowCount())throw new Error("Count must be less than or equal to the number of rows.");"number"==typeof t?t={row_index:t}:"string"==typeof t&&(t={row_addr:t});let o=this.RowCol(t);if(o.row_index+e>this.RowCount())throw new Error("Count plus the starting index must be less than or equal to the number of rows.");this.data.rows.splice(o.row_index,e)},t.ClearRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.RowCount())throw new Error("Count must be less than or equal to the number of rows.");"number"==typeof t?t={row_index:t}:"string"==typeof t&&(t={row_addr:t});let o=this.RowCol(t);if(o.row_index+e>this.RowCount())throw new Error("Count plus the starting index must be less than or equal to the number of rows.");for(let t=o.row_index;t<o.row_index+e;t++)this.data.rows[t]=n.clone(this.options.blank_row)},t.InsertBlankRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.RowCount())throw new Error("Count must be less than or equal to the number of rows.");let o=!1;"number"==typeof t?(t<0&&(o=!0),t={row_index:t}):"string"==typeof t&&(t={row_addr:t});let r=this.RowCol(t);if(r.row_index>=this.RowCount())throw new Error("Starting index must be less than the number of rows.");let i=[];for(let t=0;t<e;t++)i.push(n.clone(this.options.blank_row));o?this.data.rows.splice(r.row_index+1,0,...i):this.data.rows.splice(r.row_index,0,...i)},t.InsertRows=function(e,t){for(n.value_missing(t)&&(t=0),n.value_missing(e)&&(e=[n.clone(this.options.blank_row)]);t>this.data.rows.length;)this.data.rows.push(n.clone(this.options.blank_row));{let t=0;for(e.forEach(e=>{t<e.length&&(t=e.length)});t>this.data.column_headings.length;)this.data.column_headings.push("")}t===this.data.rows.length?this.data.rows.push(...e):this.data.rows.splice(t,0,...e)}}])}));