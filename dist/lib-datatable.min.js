!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.lib_datatable=t():e.lib_datatable=t()}("undefined"!=typeof self?self:this,(function(){return(()=>{"use strict";var e={485:(e,t,o)=>{const n=o(585);t.RowCol=function(e,t){let o={row_num:null,row_addr:null,row_index:null,col_num:null,col_addr:null,col_index:null};if("object"==typeof e&&null!==e){if(n.value_missing(e.row_index))if(n.value_missing(e.row_num))n.value_missing(e.row_addr)||(o.row_index=n.address2number(e.row_addr)-1);else{if(e.row_num<0)throw new Error("RowCol.row_num must be zero or positive.");o.row_index=e.row_num-1}else e.row_index>=0?o.row_index=n.resolve_index(Number.MAX_SAFE_INTEGER,e.row_index):o.row_index=n.resolve_index(this.data.rows.length,e.row_index);if(n.value_missing(e.col_index))if(n.value_missing(e.col_num))n.value_missing(e.col_addr)||(o.col_index=n.address2number(e.col_addr)-1);else{if(e.col_num<0)throw new Error("RowCol.col_num must be zero or positive.");o.col_index=e.col_num-1}else e.col_index>=0?o.col_index=n.resolve_index(Number.MAX_SAFE_INTEGER,e.col_index):o.col_index=n.resolve_index(this.data.column_headings.length,e.col_index)}else if("string"==typeof e){for(let t=0;t<e.length;t++){let n=e.substr(t,1);if(!isNaN(parseInt(n))){o.col_addr=e.substr(0,t),o.row_num=parseInt(e.substr(t));break}}if(null===o.col_addr||null===o.row_num)throw new Error(`Invalid address [${e}].`);o.row_index=o.row_num-1,o.col_index=n.address2number(o.col_addr)-1}else n.value_missing(e)||"number"==typeof e&&(o.row_index=e>=0?n.resolve_index(Number.MAX_SAFE_INTEGER,e):n.resolve_index(this.data.rows.length,e)),n.value_missing(t)||("string"==typeof t&&(t=n.address2number(t)-1),o.col_index=t>=0?n.resolve_index(Number.MAX_SAFE_INTEGER,t):n.resolve_index(this.data.column_headings.length,t));return null!==o.row_index&&(o.row_num=o.row_index+1,o.row_addr=n.number2address(o.row_num)),null!==o.col_index&&(o.col_num=o.col_index+1,o.col_addr=n.number2address(o.col_num)),o},t.GetValue=function(e,t){let o=this.RowCol(e,t);if(null===o.row_index)throw new Error(`Invalid RowIndex [${o.row_index}].`);if(null===o.col_index)throw new Error(`Invalid ColIndex [${o.col_index}].`);if(o.row_index>=this.data.rows.length)throw new Error(`RowIndex [${o.row_index}] does not exist.`);let r=this.data.rows[o.row_index];return o.col_index>=r.length?n.clone(this.options.blank_value):r[o.col_index]},t.SetValue=function(e,t,o){let r=this.RowCol(t,o);if(null===r.row_index)throw new Error(`Invalid RowIndex [${r.row_index}].`);if(null===r.col_index)throw new Error(`Invalid ColIndex [${r.col_index}].`);let i=this.data.rows[r.row_index];for(;r.col_index>=this.data.column_headings.length;)this.data.column_headings.push(""),this.data.column_infos.push({});for(;r.col_index>=i.length;)i.push(n.clone(this.options.blank_value));i[r.col_index]=e}},551:(e,t,o)=>{const n=o(585);t.DeleteColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.ColumnCount())throw new Error("Count must be less than or equal to the number of columns.");"number"==typeof t?t={col_index:t}:"string"==typeof t&&(t={col_addr:t});let o=this.RowCol(t);if(o.col_index+e>this.ColumnCount())throw new Error("Count plus the starting index must be less than or equal to the number of columns.");this.data.column_headings.splice(o.col_index,e),this.data.column_infos.splice(o.col_index,e);for(let t=0;t<this.data.rows.length;t++){let n=this.data.rows[t];o.col_index>=n.length||n.splice(o.col_index,e)}},t.ClearColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.ColumnCount())throw new Error("Count must be less than or equal to the number of columns.");"number"==typeof t?t={col_index:t}:"string"==typeof t&&(t={col_addr:t});let o=this.RowCol(t);if(o.col_index+e>this.ColumnCount())throw new Error("Count plus the starting index must be less than or equal to the number of columns.");for(let t=0;t<this.data.rows.length;t++)for(let r=0;r<e;r++)this.SetValue(n.clone(this.options.blank_value),t,o.col_index+r)},t.InsertBlankColumns=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtColumn is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");let o=!1;"number"==typeof t?(t<0&&(o=!0),t={col_index:t}):"string"==typeof t&&(t={col_addr:t});let r=this.RowCol(t),i=[],l=[];for(let t=0;t<e;t++)i.push(""),l.push({});this.data.column_headings.splice(r.col_index,0,...i),this.data.column_infos.splice(r.col_index,0,...l);let s=[];for(let t=0;t<e;t++)s.push(this.options.blank_value);for(let e=0;e<this.data.rows.length;e++){let t=this.data.rows[e];o?t.splice(r.col_index+1,0,...n.clone(s)):t.splice(r.col_index,0,...n.clone(s))}},t.ColumnHeading=function(e,t=null){if(n.value_missing(e))throw new Error("AtColumn is required.");"number"==typeof e?e={col_index:e}:"string"==typeof e&&(e={col_addr:e});let o=this.RowCol(e);return n.value_missing(t)||(this.data.column_headings[o.col_index]=t),this.data.column_headings[o.col_index]},t.ColumnHeadings=function(e=null){if(!n.value_missing(e)){if(!Array.isArray(e))throw new Error("The parameter [Headings] must be an array.");e.length>this.ColumnCount()&&this.InsertBlankColumns(e.length-this.ColumnCount(),this.ColumnCount());for(let t=0;t<e.length;t++)this.data.column_headings[t]=e[t]}return n.clone(this.data.column_headings)},t.ColumnInfo=function(e,t=null){if(n.value_missing(e))throw new Error("AtColumn is required.");"number"==typeof e?e={col_index:e}:"string"==typeof e&&(e={col_addr:e});let o=this.RowCol(e);return n.value_missing(t)||(this.data.column_infos[o.col_index]=t),this.data.column_infos[o.col_index]}},134:(e,t,o)=>{const n=o(585);t.ToObject=function(e){if(n.value_missing(e))throw new Error("AtRow is required.");"number"==typeof e?e={row_index:e}:"string"==typeof e&&(e={row_addr:e});let t=this.RowCol(e),o={};for(let e=0;e<this.data.column_headings.length;e++){let n=this.data.column_headings[e];n&&n.length||(n=`column${e}`),o[n]=this.GetValue(t.row_index,e)}return o},t.DeleteRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.RowCount())throw new Error("Count must be less than or equal to the number of rows.");"number"==typeof t?t={row_index:t}:"string"==typeof t&&(t={row_addr:t});let o=this.RowCol(t);if(o.row_index+e>this.RowCount())throw new Error("Count plus the starting index must be less than or equal to the number of rows.");this.data.rows.splice(o.row_index,e)},t.ClearRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");if(e>this.RowCount())throw new Error("Count must be less than or equal to the number of rows.");"number"==typeof t?t={row_index:t}:"string"==typeof t&&(t={row_addr:t});let o=this.RowCol(t);if(o.row_index+e>this.RowCount())throw new Error("Count plus the starting index must be less than or equal to the number of rows.");for(let t=o.row_index;t<o.row_index+e;t++)this.data.rows[t]=n.clone(this.options.blank_row)},t.InsertBlankRows=function(e,t){if(n.value_missing(e))throw new Error("Count is required.");if(n.value_missing(t))throw new Error("AtRow is required.");if(e<1)throw new Error("Count must be greater than or equal to one.");let o=!1;"number"==typeof t?(t<0&&(o=!0),t={row_index:t}):"string"==typeof t&&(t={row_addr:t});let r=this.RowCol(t);if(r.row_index>this.RowCount())throw new Error("Starting index must be less than or equal to the number of rows.");let i=[];for(let t=0;t<e;t++)i.push(n.clone(this.options.blank_row));o?this.data.rows.splice(r.row_index+1,0,...i):this.data.rows.splice(r.row_index,0,...i)},t.InsertRows=function(e,t){for(n.value_missing(t)&&(t=0),n.value_missing(e)&&(e=[n.clone(this.options.blank_row)]);t>this.data.rows.length;)this.data.rows.push(n.clone(this.options.blank_row));{let t=0;for(e.forEach((e=>{t<e.length&&(t=e.length)}));t>this.data.column_headings.length;)this.data.column_headings.push(""),this.data.column_infos.push({})}t===this.data.rows.length?this.data.rows.push(...e):this.data.rows.splice(t,0,...e)}},418:(e,t,o)=>{const n=o(585);t.TransposeTable=function(){let e=[],t=[];for(let o=0;o<this.data.rows.length;o++)e.push(""),t.push({});let o=[];for(let e=0;e<this.data.column_headings.length;e++){let t=[];for(let o=0;o<this.data.rows.length;o++)t.push(this.GetValue(o,e));o.push(t)}this.data.column_headings=e,this.data.column_infos=t,this.data.rows=o},t.AppendTable=function(e,t){if(!e.IsDatatable)throw new Error("The parameter [OtherTable] must be a datatable.");let o=e.ToMatrix(t);if(!o.length)return;let n=this.ColumnCount(),r=o[0].length;r>n&&this.InsertBlankColumns(r-n,n),this.InsertRows(o,this.RowCount())},t.JoinTable=function(e,t,o,r,i){if(n.value_missing(e))throw new Error("The required parameter [AtColumn] is missing.");if(n.value_missing(t))throw new Error("The required parameter [JoinType] is missing.");if(n.value_missing(o))throw new Error("The required parameter [RightTable] is missing.");if(n.value_missing(r))throw new Error("The required parameter [RightColumn] is missing.");if(!o.IsDatatable)throw new Error("The parameter [RightTable] must be a datatable.");let l=this.ColumnCount(),s=this.GetMatrix(0,e,this.RowCount()-1,e);s=s.map((e=>e[0]));let u=o.GetMatrix(0,r,o.RowCount()-1,r);u=u.map((e=>e[0]));let a=this.ToMatrix(),h=o.ToMatrix(i);if(!h.length)return;if(!h[0].length)return;let d=h[0].length;this.DeleteRows(this.RowCount(),0),this.InsertBlankColumns(d,l);let w=[];if("inner"===(t=t.toLowerCase()))s.forEach(((e,t)=>{u.forEach(((o,n)=>{o===e&&w.push({left:t,right:n})}))}));else if("left"===t)s.forEach(((e,t)=>{let o=0;u.forEach(((n,r)=>{n===e&&(w.push({left:t,right:r}),o++)})),o||w.push({left:t,right:null})}));else if("right"===t)u.forEach(((e,t)=>{let o=0;s.forEach(((n,r)=>{e===n&&(w.push({left:r,right:t}),o++)})),o||w.push({left:null,right:t})}));else{if("full"!==t)throw new Error(`Unknown value for [JoinType] [${t}].`);s.forEach(((e,t)=>{let o=0;u.forEach(((n,r)=>{n===e&&(w.push({left:t,right:r}),o++)})),o||w.push({left:t,right:null})})),u.forEach(((e,t)=>{let o=0;s.forEach(((t,n)=>{e===t&&o++})),o||w.push({left:null,right:t})}))}w.forEach((e=>{let t=this.RowCount();null!==e.left&&this.SetMatrix([a[e.left]],t,0),null!==e.right&&this.SetMatrix([h[e.right]],t,l)}))}},487:(e,t,o)=>{const n=o(585);t.RowCount=function(e){if(!n.value_missing(e)){if(e<0)throw new Error("Count must be zero or positive.");for(;e>this.data.rows.length;)this.data.rows.push([]);this.data.rows.splice(e)}return this.data.rows.length},t.ColumnCount=function(e){if(!n.value_missing(e)){if(e<0)throw new Error("Count must be zero or positive.");for(;e>this.data.column_headings.length;)this.data.column_headings.push(""),this.data.column_infos.push({});this.data.column_headings.splice(e),this.data.column_infos.splice(e)}return this.data.column_headings.length},t.SetSize=function(e,t){if(n.value_missing(e))throw new Error("RowCount is required.");if(n.value_missing(t))throw new Error("ColCount is required.");this.RowCount(e),this.ColumnCount(t)},t.ToMatrix=function(e){let t=[],o=[],n=this.RowCount(),r=this.ColumnCount();e?e.forEach((e=>{let t=null;if(null===e||-1===e)t=null;else if("number"==typeof e){if(t=parseInt(e),t<0)throw new Error(`This is an invalid column index [${t}].`);if(t>=r)throw new Error(`This is an invalid column index [${t}].`)}else if(t=this.data.column_headings.findIndex((t=>e===t)),t<0)throw new Error(`This column does not exist [${e}].`);o.push(t)})):this.data.column_headings.forEach(((e,t)=>{o.push(t)}));for(let e=0;e<n;e++){let n=[];for(let t=0;t<o.length;t++){let r=o[t];null===r?n.push(null):n.push(this.GetValue(e,r))}t.push(n)}return t},t.GetMatrix=function(e,t,o,r){if(n.value_missing(e))throw new Error("FromRowIndex is required.");if(n.value_missing(t))throw new Error("FromColumnIndex is required.");if(n.value_missing(o))throw new Error("ToRowIndex is required.");if(n.value_missing(r))throw new Error("ToColumnIndex is required.");let i=[];for(let n=e;n<=o;n++){let e=[];for(let o=t;o<=r;o++){let t=this.GetValue(n,o);e.push(t)}i.push(e)}return i},t.SetMatrix=function(e,t,o){let n=this.RowCol(t,o);if(null===n.row_index)throw new Error(`Invalid RowIndex [${n.row_index}].`);if(null===n.col_index)throw new Error(`Invalid ColIndex [${n.col_index}].`);let r=n.row_index+e.length;r>this.RowCount()&&this.RowCount(r);for(let t=0;t<e.length;t++){let o=e[t];for(let e=0;e<o.length;e++){let r=o[e],i=n.col_index+o.length;i>this.ColumnCount()&&this.ColumnCount(i),this.SetValue(r,n.row_index+t,n.col_index+e)}}},t.FromObjects=function(e){if(n.value_missing(e))throw new Error("Objects is required.");if(!Array.isArray(e))throw new Error("Objects must be an array of objects.");this.SetSize(e.length,0);for(let t=0;t<e.length;t++){let o=e[t],n=Object.keys(o);for(let e=0;e<n.length;e++){let r=this.data.column_headings.indexOf(n[e]);r<0&&(this.data.column_headings.push(n[e]),this.data.column_infos.push({}),r=this.data.column_headings.length-1);let i=o[n[e]];this.SetValue(i,t,r)}}},t.ToObjects=function(){let e=[];for(let t=0;t<this.data.rows.length;t++)e.push(this.ToObject(t));return e},t.Clone=function(){let e=this.ToObjects();return this.NewDatatableFromObjects(e)}},136:(e,t,o)=>{var n;const r=o(487),i=o(418),l=o(485),s=o(551),u=o(134);function a(){return{options:{blank_value:null,blank_row:[]},data:{row_base:0,col_base:0,rows:[],column_headings:[],column_infos:[]},IsDatatable:!0,NewDatatable:a,NewBlankDatatable:h,NewDatatableFromMatrix:d,NewDatatableFromObjects:w,RowCount:r.RowCount,ColumnCount:r.ColumnCount,SetSize:r.SetSize,ToMatrix:r.ToMatrix,GetMatrix:r.GetMatrix,SetMatrix:r.SetMatrix,ToObjects:r.ToObjects,FromObjects:r.FromObjects,Clone:r.Clone,TransposeTable:i.TransposeTable,AppendTable:i.AppendTable,JoinTable:i.JoinTable,RowCol:l.RowCol,GetValue:l.GetValue,SetValue:l.SetValue,DeleteColumns:s.DeleteColumns,ClearColumns:s.ClearColumns,InsertBlankColumns:s.InsertBlankColumns,ColumnHeading:s.ColumnHeading,ColumnHeadings:s.ColumnHeadings,ColumnInfo:s.ColumnInfo,ToObject:u.ToObject,DeleteRows:u.DeleteRows,ClearRows:u.ClearRows,InsertBlankRows:u.InsertBlankRows,InsertRows:u.InsertRows}}function h(e,t){let o=a();return o.SetValue(o.blank_value,e-1,t-1),o}function d(e){let t=a();return t.SetMatrix(e,0,0),t}function w(e){let t=a();return t.FromObjects(e),t}t.NewDatatable=a,t.NewBlankDatatable=h,t.NewDatatableFromMatrix=d,t.NewDatatableFromObjects=w,t.FromMatrix=d,t.FromObjects=w,void 0===(n=function(){return t}.call(t,o,t,e))||(e.exports=n)},585:(e,t)=>{function o(e){return null==e}t.value_missing=o,t.clone=function(e){return JSON.parse(JSON.stringify(e))},t.resolve_index=function(e,t){if(o(e))throw new Error("Count is required.");if(o(t))throw new Error("Index is required.");return t<0&&(t=e+t),t<0&&(t=null),t>=e&&(t=null),t},t.address2number=function(e){if(o(e))throw new Error("Address is required.");let t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=(e=e.toUpperCase()).length,r=0;for(let o=0;o<e.length;o++){n--;let i=e.substr(n,1),l=t.indexOf(i)+1;if(l<=0)throw new Error(`Invalid address string [${e}].`);l*=t.length**o,r+=l}return r},t.number2address=function(e){if(o(e))throw new Error("Number is required.");for(var t="",n=1,r=26;(e-=n)>=0;n=r,r*=26)t=String.fromCharCode(parseInt(e%r/n)+65)+t;return t},t.is_unique=function(e){for(let t=0;t<e.length;t++)if(e.indexOf(e[t],t+1)>=0)return!1;return!0}}},t={};return function o(n){if(t[n])return t[n].exports;var r=t[n]={exports:{}};return e[n](r,r.exports,o),r.exports}(136)})()}));